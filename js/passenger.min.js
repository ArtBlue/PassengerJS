/**
 * Passenger JS
 * @description Passenger JS is a UI/UX helper tool that allows users to create passwords that meet the minimum requirements of a website or web application with greater ease. Multiple indicators help users to identify what is missing by providing direct instantaneous feedback as users type. UX research has show that there is a notable user frustration with user password creation. This tool helps to alleviate that frustration through numerous proven UX principles.
 * @author 	Arthur Khachatryan
 * @version 0.7.1
 */
function Passenger(e){if(!e||!e.field)return console.log("Error: config, and at minimum the password field ID is required.");{var t=this,s=e.field,r=t.getElement(s),n=e.contracts||t.getContracts(),a=(n.length,t.createBox(r,n,e)),o=t.inputTypeToggle(r);t.boxDisplayToggle(o,a)}return t.sBoxID=e.field,t.box=a,t.contracts=n,t.nContracts=t.contracts.length,t.setupBoxEvents(r,a),passengers[t.sBoxID]={fulfilled:!1},t.allPassed=t.isPassFulfilled,t}function _after(e){var t,s=e.el,r=e.selNew,n=document.createElement(r),a=e.sID,o=e.sCSS,l=e.sText,i=e.aAttr,c=0;if(a&&(n.id=a),l&&(t=document.createTextNode(l),n.appendChild(t)),o&&(n.className=o),i)for(;c<i.length;c++)n.setAttribute(i[c].name,i[c].val);return s.nextSibling?s.parentNode.insertBefore(n,s.nextSibling):s.parentNode.appendChild(n),n}function _appendChild(e){var t,s,r=e.el,n=e.selNew,a=document.createElement(n),o=e.sID,l=e.sCSS,i=e.sText,c=e.sStyes;return o&&(a.id=o),i&&(t=document.createTextNode(i),a.appendChild(t)),l&&(a.className=l),c&&(s=document.createAttribute("style"),s.value=c,a.setAttributeNode(s)),r.appendChild(a),a}var passengers={};Passenger.prototype.isPassFulfilled=function(){return passengers[this.sBoxID].fulfilled},Passenger.prototype.createBox=function(e,t,s){if(!s)return console.log("Error: configuration is required to create passenger box.");console.log(s);for(var r,n=0,a=s.field,o=s.styles?" "+s.styles:"",l=t.length,i=_after({el:e,selNew:"div",sID:"passbox_"+a,sCSS:"passbox"+o}),c=_appendChild({el:i,selNew:"label",sText:"Password Must:"}),u=_after({el:c,selNew:"ul"}),d=document.createDocumentFragment(),p=a+"-rule-";l>n;n++)r=document.createElement("li"),r.textContent=t[n].label,r.id=p+t[n].name,d.appendChild(r);return u.appendChild(d),i},Passenger.prototype.boxDisplayToggle=function(e,t){function s(){var e=t.className,s=e.indexOf("show");return e=-1!=s?e.substr(0,s-1):t.className+" show",t.className=e,!1}if(!e||!t)return console.log("Error: need both, the element to add box toggle link and the box itself");var r=this.sBoxID,n=_after({el:e,selNew:"a",sID:"passbox_guide_toggle_"+r,sCSS:"toggle_guide_link",sText:"Toggle Guide",aAttr:[{name:"href",val:"#"}]});return n.addEventListener("click",s,!1),n},Passenger.prototype.inputTypeToggle=function(e){function t(){var t=e.getAttribute("type"),s="password"===t?"text":"password";return e.setAttribute("type",s),e}if(!e)return console.log("Error: field element required.");var s=this.sBoxID,r=_after({el:e,selNew:"a",sID:"passbox_type_toggle_"+s,sText:"Toggle Password",sCSS:"toggle_input_link",aAttr:[{name:"href",val:"#"}]});return r.addEventListener("click",t,!1),r},Passenger.prototype.bAllPassed=function(e,t){},Passenger.prototype.setupBoxEvents=function(e,t){var s="keyup",r=this;return e.addEventListener("focus",function(e){return this.contracts||(this.contracts=r.contracts),t.className?t.className=t.className+" show":t.className="show",this.addEventListener(s,r.userEntry,!1)},!1),e.addEventListener("blur",function(e){this.removeEventListener(s,r.userEntry,!1)},!1),e},Passenger.prototype.userEntry=function(e){for(var t,s,r,n,a,o=0,l=this.id,i=this.contracts,c=i.length,u=!0,d=l+"-rule-",p=e.target.value;c>o;o++)t=i[o].rule,s=new RegExp(t),r=i[o].name,n=s.test(p),a=document.getElementById(d+r),n?a.className="met":(a.className="",u=!1);passengers[l].fulfilled=u},Passenger.prototype.getElement=function(e){if(!e)return console.log("Error: selector is required.");var t=document.getElementById(e);return t||console.log("Error: cannot find selector.")},Passenger.prototype.getContracts=function(){var e=[{name:"lowercase",label:"Have at least one lower case character",rule:"[a-z]"},{name:"uppercase",label:"Have at least one upper case character",rule:"[A-Z]"},{name:"number",label:"Have at least one number",rule:"[0-9]"},{name:"consecutive",label:"Avoid using three or more consecutive identical characters",rule:"^(?!.*(.)\\1\\1)"},{name:"min6",label:"A minimum of 6 characters",rule:"^.{6,}$"},{name:"max12",label:"A maximum of 12 characters",rule:"^.{1,12}$"},{name:"notcommon",label:"Not be a common password",rule:"^((?!(password|abcdefgh|asdflkjh|abcd1234)).)*$"}];return e};